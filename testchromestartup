from selenium import webdriver
from selenium.webdriver.support.select import Select
import time,random

def randomchoice():
    temp = random.uniform(0,4)
    return temp

current_time = time.strftime("%Y-%m-%d-%H_%M_%S", time.localtime(time.time()))

qd = webdriver.Chrome()
qd.get("http://www.gllue.com/home/product-hr")                          # 进入谷露申请试用界面
time.sleep(2)

#定位申请试用按钮
#qd.find_element_by_xpath("/html/body/div/div/section/div/a[1]").click()                      #通过xpath来定位申请试用按钮
qd.find_element_by_css_selector("body > div > div > section > div > a:nth-child(1)").click()  #通过CSS来定位申请试用按钮
time.sleep(1)

#自动填写表单
qd.find_element_by_id("company").send_keys("autotest")                  # 定位输入框并输入关键字
qd.find_element_by_id("chineseName").send_keys("autotest")
qd.find_element_by_id("title").send_keys("autotest")
qd.find_element_by_id("location").send_keys("autotest")
qd.find_element_by_id("mobile").send_keys("18118393383")
qd.find_element_by_id("email").send_keys("eugene.yue@gllue.com")

#关于选择下拉框
#qd.find_element_by_xpath("//*[@id='source']/option[3]").click()         #固定选择一个下拉值
tempchoice = int(randomchoice())
dropdownselection = qd.find_element_by_xpath("//*[@id='scale']")         #随机选择下拉框的value
Select(dropdownselection).select_by_index(tempchoice)

qd.find_element_by_id("message").send_keys("自动测试申请试用")

#点击提交之后自动截图
qd.get_screenshot_as_file('//Users/eugene/desktop/autoscreenshot/' + current_time + '.png')

#time.sleep(2)   #等待3秒
#qd.quit()   #关闭浏览器